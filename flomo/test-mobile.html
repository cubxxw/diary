<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>æµ‹è¯•ç§»åŠ¨ç«¯ä¿®å¤</title>
  <style>
    body { 
      font-family: -apple-system, BlinkMacSystemFont, sans-serif; 
      margin: 0;
      padding: 10px;
      background: #f5f5f5;
    }
    .test-panel {
      background: white;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .status {
      font-weight: bold;
      margin-bottom: 10px;
    }
    .success { color: #28a745; }
    .error { color: #dc3545; }
    .info { color: #17a2b8; }
    iframe {
      width: 100%;
      height: 80vh;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    button {
      background: #30cf79;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #28b66a;
    }
  </style>
</head>
<body>
  <div class="test-panel">
    <h2>ğŸ”§ ç§»åŠ¨ç«¯ä¿®å¤æµ‹è¯•é¢æ¿</h2>
    
    <div class="status info">
      ğŸ“± å±å¹•å®½åº¦: <span id="screen-width"></span>px
    </div>
    
    <div class="status" id="viewport-status">
      ğŸ” Viewport: æ£€æµ‹ä¸­...
    </div>
    
    <div class="status" id="mobile-status">
      ğŸ“² ç§»åŠ¨ç«¯æ¨¡å¼: æ£€æµ‹ä¸­...
    </div>
    
    <button onclick="refreshIframe()">ğŸ”„ åˆ·æ–°æµ‹è¯•</button>
    <button onclick="openInNew()">ğŸš€ æ–°çª—å£æ‰“å¼€</button>
    <button onclick="openEnhancer()">âœ¨ å¢å¼ºç‰ˆæµ‹è¯•</button>
  </div>

  <div class="test-panel">
    <h3>åŸå§‹ flomo é¡µé¢æµ‹è¯•</h3>
    <iframe id="test-iframe" src="./cubxxw.html"></iframe>
  </div>

  <script>
    // æ£€æµ‹ç§»åŠ¨ç«¯çŠ¶æ€
    function checkMobileStatus() {
      const screenWidth = document.getElementById('screen-width');
      const viewportStatus = document.getElementById('viewport-status');
      const mobileStatus = document.getElementById('mobile-status');
      
      // å±å¹•å®½åº¦
      screenWidth.textContent = window.innerWidth;
      
      // Viewportæ£€æµ‹
      const viewport = document.querySelector('meta[name="viewport"]');
      if (viewport && viewport.content.includes('width=device-width')) {
        viewportStatus.innerHTML = 'ğŸ” Viewport: <span class="success">âœ… å·²é…ç½®</span>';
      } else {
        viewportStatus.innerHTML = 'ğŸ” Viewport: <span class="error">âŒ æœªé…ç½®</span>';
      }
      
      // ç§»åŠ¨ç«¯æ¨¡å¼æ£€æµ‹
      if (window.innerWidth <= 768) {
        mobileStatus.innerHTML = 'ğŸ“² ç§»åŠ¨ç«¯æ¨¡å¼: <span class="success">âœ… å·²æ¿€æ´»</span>';
      } else {
        mobileStatus.innerHTML = 'ğŸ“² ç§»åŠ¨ç«¯æ¨¡å¼: <span class="info">ğŸ’» æ¡Œé¢æ¨¡å¼</span>';
      }
    }
    
    function refreshIframe() {
      const iframe = document.getElementById('test-iframe');
      iframe.src = iframe.src;
    }
    
    function openInNew() {
      window.open('./cubxxw.html', '_blank');
    }
    
    function openEnhancer() {
      window.open('./enhancer.html', '_blank');
    }
    
    // ç›‘å¬iframeæ¶ˆæ¯
    window.addEventListener('message', function(event) {
      if (event.data.type === 'IFRAME_MOBILE_FIX_COMPLETE') {
        console.log('âœ… iframeç§»åŠ¨ç«¯ä¿®å¤å®Œæˆ', event.data);
        
        // æ˜¾ç¤ºæˆåŠŸæç¤º
        const successMsg = document.createElement('div');
        successMsg.className = 'test-panel';
        successMsg.innerHTML = '<div class="status success">âœ… iframeç§»åŠ¨ç«¯ä¿®å¤å·²å®Œæˆï¼</div>';
        document.body.insertBefore(successMsg, document.body.firstChild);
        
        // 3ç§’åç§»é™¤
        setTimeout(() => {
          successMsg.remove();
        }, 3000);
      }
    });
    
    // åˆå§‹æ£€æµ‹
    checkMobileStatus();
    
    // çª—å£å¤§å°å˜åŒ–æ—¶é‡æ–°æ£€æµ‹
    window.addEventListener('resize', checkMobileStatus);
    
    // ç¡®ä¿viewportè®¾ç½®
    let viewport = document.querySelector('meta[name="viewport"]');
    if (!viewport) {
      viewport = document.createElement('meta');
      viewport.name = 'viewport';
      viewport.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
      document.head.appendChild(viewport);
      checkMobileStatus();
    }
  </script>
</body>
</html>